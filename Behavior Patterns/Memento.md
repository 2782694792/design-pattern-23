# 行为型模式 —— 备忘录模式

- 保存一个对象的某个状态，以便再适当地时候恢复对象；

- 在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态；

## 模式组成

1. Memento: 备忘录，存储原发器对象的内部状态。原发器根据需要决定备忘录存储原发器的哪些内部状态；防止原发器以外的其他对象访问备忘录; 

> 备忘录实际上有两个接口: 
> 1. 管理者只能看到备忘录的窄接口————它只能将备忘录传递给其他对象;
>
> 2. 原发器能够看到一个宽接口，允许它访问返回到先前状态所需的所有数据。

2. Originator: 原发器，负责记录当前时刻它的内部状态，包括保存和管理状态，备忘录通过原发器进行内部状态的保存和恢复；

3. Caretaker: 管理器，负责管理和保存好备忘录；但是，不能对备忘录的内容进行操作或检查。

## 工作流程

1. 一个备忘录是一个对象，它存储另一个对象再某个瞬间的内部状态（备忘录的原发器），当需要设置原发器的检查点时，取消操作机制会想原发器请求一个备忘录；

2. 管理器向原发器请求一个备忘录，保留一段时间后，将其送回给原发器；有的时候管理者不会将备忘录返回给原发器，因为原发器可能根本不需要退到先前的状态；

3. 备忘录是被动的，只有创建备忘录的原发器会对它的状态进行赋值和检索，对其他对象是“不可见”的。

## 利弊

`优点`

1. 给用户提供了一种可以恢复状态的机制，可以使用户能够比较方便地回到某个历史的状态；

2. 简化了发起人的的职责，将状态的存储和获取进行了隔离，实现了信息的封装，使得用户不需要关心状态的保存细节。

`缺点`

1. 类的成员变量过多，占用更大的资源，且每一次保存都会消耗一定的内存;

2. 若每个快照内容都非常大，会消耗大量内存。

## 使用场景

1. 需要保存/恢复数据（快照）的相关状态场景；

2. 提供一个可回滚的操作；

3. 对象之外保存状态，且除了本身其他对象无法访问保存内容。